---
emoji: "🤔"
title: "Korea Webtoon API 업데이트 후기"
description: "Daum 웹툰의 대규모 변화로 인한 API 업데이트 후기"
date: "2021-11-17"
tag: [Project]
---

## 웹툰 API - Korea Webtoon API

<img src="https://user-images.githubusercontent.com/71566740/142148364-0c963e54-4709-43f4-828a-93cf62073354.png" class="img large"/>

이전에 2020년말 쯤 웹툰 통합 정보 사이트를 만들어 보자는 생각으로 Webtoon Hub라는 토이프로젝트를 진행하면서 필요했던 웹툰 정보들을 뿌려주는 서버를 만들었습니다.

프로젝트를 완성하고 해당 API를 버려두긴 아까워서 문서도 만들고 공개로 호스팅으로 돌리면서 대학교 동기나 후배들에게 제공하고 있었습니다.

### 💥 대규모 변화

2021년 8월 기존 Daum 웹툰이 Kakao 웹툰으로 개편되었습니다.

단순 명칭 변경이 아닌 실제 페이지에 많은 변화가 있었는데 이때문에 기존에 만들어 두었던 API 사용이 불가능한 상황이라 해당 프로젝트를 업데이트 하게 되었습니다.

### 👉 개발방향

기존 API는 Express 기반으로 JSON 형태의 데이터를 제공하고 있었는데 각 플랫폼별로 크롤링 모듈을 따로 설계해 두어서 사실 해당 모듈만 수정하면 되는 작업이었지만 그동안 벼르고 있었던 NestJS를 써보자는 생각으로 오히려 Naver 웹툰 크롤러 모듈을 제외한 모든 코드를 다시 작성하게 되었습니다.

<br/>추가로 카카오 페이지 플랫폼의 웹툰 정보들도 제공할 수 있도록 추가했습니다.

## 웹툰 정보 수집

### <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Naver</title><path d="M1.6 0S0 0 0 1.6v20.8S0 24 1.6 24h20.8s1.6 0 1.6-1.6V1.6S24 0 22.4 0zm3.415 5.6h4.78l4.425 6.458V5.6h4.765v12.8h-4.78L9.78 11.943V18.4H5.015Z"/></svg> Naver 웹툰

Naver 웹툰 크롤링이 모든 부분들중 가장 쉬웠습니다.

사실 이전에 크롤링 코드를 모듈화 해놓고 그 부분은 건들지 않아도 정상 작동해서 이번 업데이트에서는 결과 데이터 형식을 제외하고는 크게 수정한 부분이 없습니다.

한 페이지에 있는 웹툰들은 모두 한번에 표시되는 방식이었고 딱히 크롤링을 방지하기 위한 장치도 없었습니다.

다만 속도를 위해 PC페이지가 아닌 모바일 페이지를 대상으로 크롤링했습니다.

### <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Kakao</title><path d="M3.0743 10.4403l.655.4728-1.6101 2.0192 1.8647 2.2373-.646.5004-2.201-2.6924zm-2.2376 5.102H0V8.5121l.8367-.182zm20.944-4.3837c-.4364 0-.7715.1637-1.0049.4912-.2338.3274-.3505.8064-.3505 1.437 0 .6247.1167 1.096.3505 1.4143.2334.3183.5685.4775 1.0049.4775.4423 0 .7804-.1593 1.0143-.4775.2332-.3182.35-.7896.35-1.4142 0-.6307-.1168-1.1097-.35-1.4371-.234-.3275-.572-.4912-1.0143-.4912m0-.673c.691 0 1.234.2245 1.6277.673.3944.4488.5916 1.0915.5916 1.9283 0 .8244-.1955 1.4583-.5868 1.901-.3909.4422-.9356.6637-1.6325.6637-.691 0-1.234-.2215-1.6277-.6638-.3944-.4426-.5916-1.0765-.5916-1.901 0-.8367.1984-1.4794.5957-1.9282.3973-.4485.9385-.673 1.6236-.673m-5.534 4.4658a1.496 1.496 0 0 0 .3576-.0456 2.8804 2.8804 0 0 0 .3713-.1181 2.0066 2.0066 0 0 0 .3488-.1774 2.0778 2.0778 0 0 0 .2895-.2229v-1.1641h-.8693c-.441 0-.7626.0758-.9645.2274-.2025.1516-.3031.391-.3031.7185 0 .5214.2563.7822.7697.7822m-1.5704-.7458c0-.5032.1682-.887.5045-1.1504.337-.2638.826-.396 1.4691-.396h.964v-.3182c0-.77-.3393-1.155-1.0185-1.155-.2184 0-.447.0304-.6869.091-.2398.0608-.4594.1365-.659.2274l-.2457-.5913c.2487-.1394.517-.2469.8047-.323.2878-.0754.5685-.1136.8414-.1136 1.176 0 1.7646.6276 1.7646 1.8826v3.1833h-.6188l-.1-.5457c-.2488.2001-.5134.3547-.796.464-.2817.1092-.55.1637-.8046.1637-.4429 0-.7899-.1258-1.0416-.3775-.2515-.2517-.3772-.5987-.3772-1.0413m-1.6508-3.7653l.655.4728-1.6095 2.0192 1.864 2.2373-.6454.5004-2.201-2.6924zm-2.237 5.102h-.8367V8.5121l.8368-.182zm-4.4936-.5909c.1148 0 .2339-.0151.3576-.0456a2.8794 2.8794 0 0 0 .3713-.1181 1.9842 1.9842 0 0 0 .3488-.1774 2.0477 2.0477 0 0 0 .29-.2229v-1.1641h-.8698c-.4404 0-.762.0758-.9645.2274-.202.1516-.3031.391-.3031.7185 0 .5214.2563.7822.7697.7822m-1.5704-.7458c0-.5032.1682-.887.5052-1.1504.3363-.2638.826-.396 1.4684-.396h.9646v-.3182c0-.77-.3399-1.155-1.019-1.155-.218 0-.4471.0304-.6863.091-.2398.0608-.4595.1365-.6597.2274l-.2457-.5913c.2487-.1394.517-.2469.8053-.323.2878-.0754.5684-.1136.8408-.1136 1.1766 0 1.7646.6276 1.7646 1.8826v3.1833h-.6182l-.1001-.5457c-.2487.2001-.514.3547-.7958.464-.282.1092-.5501.1637-.8053.1637-.4423 0-.7893-.1258-1.041-.3775-.2516-.2517-.3778-.5987-.3778-1.0413Z"/></svg> Kakao 웹툰

카카오 웹툰은 특이하게 Kakao 웹툰과 페이지로 나눠저 서비스 되고있습니다.

Naver 웹툰과 달리 Kakao 웹툰은 초기에 모든 정보들을 가져와서 웹에 뿌려주는 방식이 아닌 필요할때 서버에 요청해 그때 그때 필요한 데이터들을 가져와 뿌려주는 방식으로 한번의 접근만으로 페이지의 모든 정보를 가져올 수 없었습니다.

<br/>다음 웹툰의 요청들을 개발자 도구로 분석하면서 다음 웹툰이 요청을 보내는 URL을 알 수 있었고 별다른 인증 없이 다음 웹툰의 클라이언트와 같은 데이터를 요청할 수 있는걸 확인해서 이런 방법으로 정보들을 가져왔습니다.

#### Kakao 웹툰

처음에는 Naver 웹툰과 같이 Kakao 웹툰 페이지에서 정보를 얻으려고 시도했지만 성능이 너무 좋지 않았고 이전 처럼 Kakao 자체 서버에 요청해서 데이터를 받아오는 방법으로 진행했습니다.

이부분에서 정말 여러가지 시도를 했고 그부분에 대해서는 아래 '**🔥 발생했던 이슈**'에 후술하겠습니다.
